
  /**
   * 指定したtripの指定した停留所での実際の到着時刻を取得
   * @param {string} tripId - トリップID
   * @param {string} stopId - 停留所ID
   * @returns {Promise<string|null>} 到着時刻（HH:MM:SS形式）またはnull
   */
  async getArrivalTime(tripId, stopId) {
    if (this.useDummyData) {
      return null;
    }

    try {
      await this.initializeDb();

      const stoptimes = await getStoptimes({
        trip_id: tripId,
        stop_id: stopId
      });

      if (stoptimes && stoptimes.length > 0) {
        // arrival_timeがあればそれを返す、なければdeparture_timeを返す
        return stoptimes[0].arrival_time || stoptimes[0].departure_time;
      }

      return null;
    } catch (error) {
      console.error('Error fetching arrival time:', error);
      return null;
    }
  }
